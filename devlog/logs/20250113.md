# Topics

- The WHY pitch
- Identifying important trees
- Discussion of selection's effect on results

---

### From 2025-01-13 to 2025-01-26

There are many similarities between `terracotta` and `EEMS` (Petkova et al. 2016) with both generating effective migration surfaces from genetic datasets. `EEMs` uses SNP and microsatellites to create a dissimilarity matrix between samples. Pairing this with the spatial coordinates of samples, the method can map out regions of the surface that require low or high migration to connect things together.

Other studies have shown that ARG/Tree methods can better highlight the underlying pattern by using the expected versus observed divergence (Speidel et al. 2025, Doc's preprint from 2024?). I believe that `terracotta` is kind of doing the same thing by using the trees rather than the mutations to look at dissimilarity between samples. Is this enough to differentiate  `terracotta` and make it worth working out this new method?

I think a potentially cool area to expand into that `EEMS` could not necessarily do is looking at loci (in this case trees) that fall outside of the standard migration patterns seen across the genome. I don't believe that `EEMS` would have had the power to do this as they would only have a single mutation here and there to look at, but the tree could give us more information. There are a few setups that I could see this being used:

- Hybrid zone where gene flow occurs across the genome except for standout loci. These loci would have high $F_{st}$ but should also estimate a different migration map if there is geographic correlation to population structure. One advantage compared to $F_{st}$ is you do not need to group samples prior to running the analysis as the migration map does not require labeling in inputs.
    - Silu Wang's Pacific Northwest warblers
    - Arka Pal's Spanish snapdragons

- Adaptation to local environments where selection prevents the gene flow of critical loci. Similar to the hybrid zone example, this would generate a differently shape migration map with regions of slow migration that did not exist in the "neutral" map.

- Selective sweeps which require higher effective migration to handle the more recent coalescent times.

One thing to consider is that we won't have nearly the same amount of power when comparing individual trees versus using them all together to build the map. As long as we are working more qualitatively in our comparison, I think that this is okay. We may be better at identifying scenarios like selective sweeps compared to reductions in gene flow due to the  nature of `terracotta` likelihood curves heavily penalizing migration rates that are too low.

![Tree By Tree View Of Migration Rate Likelihoods](../assets/20250113/tree_by_tree.png)

The above shows some of the variability in likelihoods that we see between trees even when all of the trees are generated under the same parameters. Now, if one of the trees was for a locus under recent selection, I would expect it to have much lower likelihoods for low migration rates.

Simulations will need to be done in `SLiM` rather than `msprime` so that the trees can take into account selection.